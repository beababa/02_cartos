---
title: "Recup fichier ads"
author: "B. Maranget"
date: "20/10/2021"
output: 
  html_document: 
    number_sections: yes
    toc: yes
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache = TRUE)
# Passer la valeur suivante à TRUE pour reproduire les extractions.
knitr::opts_chunk$set(eval = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```


# Objet

reprise de données ADS pour Operis - Oxalis


# Conversion XLS CSV

A ne faire qu'une fois pour pouvoir travailler sur le linux

```{r}
library(xlsx)
library(readxl)
ADSOp <- read.xlsx("../data/Format_ADS2007.xls", startRow= 1, header = TRUE,sheetIndex = 1, encoding = "UTF-8")
write.csv(ADSOp, "../data/adsOp.csv", fileEncoding = "UTF-8")
i <- 1
for (i in 1:10) {
  data <- read_excel("../data/REGISTRE ADS.xls", sheet = i)
  write.csv(data, paste0("../data/ads", i, ".csv"), na ="", fileEncoding = "UTF-8")
}
```

Nettoyage du fichier 

Pb d'encodage sur lg de titre, on ouvre avec libre office
TODO retester avec un enregistrement en UTF-8

```{r}
registre <- read.csv("../data/ads1b.csv")
# 26 colonnes uniquement
noms <- names(registre)[1:26]
registre <- registre [, noms]
# 5358  numéros d'archivage
registre [registre$N..d.Archivage == "5358",]
tail(registre)
```



